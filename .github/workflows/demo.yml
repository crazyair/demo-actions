name: DingTalk Release Notify

# on:
#   workflow_dispatch: # manual trigger workflow to nofify dingTalk
#   release:
#     types: [published, edited]

on:
  discussion:
    types: [created, edited, locked, unlocked]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # - uses: actions/checkout@v4
      # - uses: actions/setup-node@v4
      #   with:
      #     node-version: 18
      - name: aaa
        run: node -v
      - name: dingtalk robot message
        # uses: fifsky/dingtalk-action@master
        # with:
        #   url: ${{ secrets.DINGTALK_WEBHOOK}}
        #   type: markdown
        #   content: |
        #     # Tips
        #     ## Hello
        #     > from github action message
        #     > ^_^
        uses: northwang-lucky/chatbot-webhook-client@v1.1.1
        with:
          # Required - DingTalk/Lark/WeCom
          app: DingTalk
          webhook: "https://oapi.dingtalk.com/robot/send?access_token=${{ secrets.DING_TALK_ACCESS_TOKEN }}"
          # Optional - Used for sign
          # secret: xxxx
          # template: >-
          #   {
          #     "msgtype": "markdown",
          #     "markdown": {
          #       "title": "aaaa",
          #       "text": "### ğŸ”¥ @afc163 åˆ›å»ºäº† PR\n[docs(:sparkles:): release 5.15.3](https://qq.com) \n > ğŸ’¬ å¿«æ¥ CR å§ï¼"
          #        }
          #   }

          template: >-
            {
              "msgtype": "markdown",
              "markdown": {
                "title": "ğŸ”¥ @${{ github.event.discussion.user.login }} åˆ›å»ºäº†è®¨è®ºï¼š${{ github.event.discussion.title }} ${{ github.event.discussion.html_url }}",
                "text": "### ğŸ”¥ @${{ github.event.discussion.user.login }} åˆ›å»ºäº†è®¨è®º \n ### [${{ github.event.discussion.title }}](${{ github.event.discussion.html_url }}) <hr /> \n > ğŸ’¬ æ¬¢è¿å‰å¾€ GitHub è¿›è¡Œè®¨è®ºï¼Œç¤¾åŒºå¯èƒ½éœ€è¦ä½ çš„å¸®åŠ©ã€‚"
              }
            }

      # - uses: visiky/dingtalk-release-notify@main
      #   with:
      #     DING_TALK_TOKEN: ${{ secrets.DING_TALK_ACCESS_TOKEN }}
      #     notify_title: "ğŸ‰ DingTalk Release Notify å‘å¸ƒ release {release_tag} ğŸ‰" # Template of nofify title message in DingTalk
      #     notify_body: "## { title }<hr /> ![](https://gw.alipayobjects.com/zos/antfincdn/pJ5JP3Ntkd/2021-08.png) <hr /> { body } <hr />" # Template of nofify body message in DingTalk
      #     notify_footer: "> å‰å¾€ [**G2Plot**]({ release_url }) æŸ¥çœ‹å®Œæ•´ä¿¡æ¯." # Template of nofify footer message in DingTalk
      #     at_all: false # whether to ding everybody
